---
phase: 07-colony-verification
plan: 05
type: execute
wave: 4
depends_on: ["07-01", "07-02", "07-03", "07-04"]
files_modified:
  - .aether/utils/test-voting-system.sh
autonomous: true

must_haves:
  truths:
    - "Voting system test suite exists and passes all tests"
    - "Supermajority calculation verified with edge cases (0/4, 1/4, 2/4, 3/4, 4/4 APPROVE)"
    - "Critical veto verified (blocks approval despite supermajority)"
    - "Issue deduping verified (merges duplicates, tags multi-watcher)"
    - "Weight calculator verified (asymmetric updates, clamping, domain bonus)"
    - "Vote recording verified (stores in COLONY_STATE.json, outcome=pending)"
    - "Watcher weight updates verified (connects to Phase 8 meta-learning)"
  artifacts:
    - path: ".aether/utils/test-voting-system.sh"
      provides: "Comprehensive test suite for voting system"
      contains: "Tests for supermajority, Critical veto, issue deduping, weight calculation, vote recording"
      exports: ["test_all", "test_supermajority", "test_critical_veto", "test_deduping", "test_weights", "test_recording"]
  key_links:
    - from: "test-voting-system.sh"
      to: "vote-aggregator.sh"
      via: "Tests supermajority calculation and Critical veto"
      pattern: "source.*vote-aggregator\\.sh.*test_supermajority"
    - from: "test-voting-system.sh"
      to: "issue-deduper.sh"
      via: "Tests issue deduplication"
      pattern: "source.*issue-deduper\\.sh.*test_deduping"
    - from: "test-voting-system.sh"
      to: "weight-calculator.sh"
      via: "Tests weight calculation and clamping"
      pattern: "source.*weight-calculator\\.sh.*test_weights"
    - from: "test-voting-system.sh"
      to: "watcher_weights.json"
      via: "Verifies weight persistence and updates"
      pattern: "watcher_weights\\.json"
---

<objective>
Create a comprehensive test suite for the voting system and verify all components work correctly. This test suite validates supermajority calculation, Critical veto power, issue deduplication, weight calculation (asymmetric updates, clamping, domain bonus), and vote recording for meta-learning.

Purpose: Ensure the voting system is correct and reliable before using it for actual verification. Tests verify edge cases, boundary conditions, and integration between components.

Output: test-voting-system.sh test suite that validates all voting system components and passes all tests.
</objective>

<execution_context>
@~/.claude/cosmic-dev-system/workflows/execute-plan.md
@~/.claude/cosmic-dev-system/templates/summary.md
</execution_context>

<context>
@.planning/STATE.md
@.planning/ROADMAP.md
@.planning/phases/07-colony-verification**---multi-perspective-verification-with-weighted-voting-and-belief-calibration/07-CONTEXT.md
@.planning/phases/07-colony-verification**---multi-perspective-verification-with-weighted-voting-and-belief-calibration/07-RESEARCH.md
@.aether/utils/vote-aggregator.sh
@.aether/utils/issue-deduper.sh
@.aether/utils/weight-calculator.sh
@.aether/utils/spawn-tracker.sh
@.aether/data/watcher_weights.json
@.aether/data/COLONY_STATE.json
@.aether/utils/test-spawning-safeguards.sh
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create comprehensive voting system test suite</name>
  <files>.aether/utils/test-voting-system.sh</files>
  <action>
Create .aether/utils/test-voting-system.sh following test-spawning-safeguards.sh pattern:

```bash
#!/bin/bash
# Aether Voting System Test Suite
# Tests supermajority calculation, Critical veto, issue deduping, weight calculation, vote recording
#
# Usage:
#   bash .aether/utils/test-voting-system.sh

# Find Aether root
SCRIPT_PATH="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
AETHER_ROOT="$(cd "$SCRIPT_PATH/../.." && pwd)"

# Test counters
TESTS_RUN=0
TESTS_PASSED=0
TESTS_FAILED=0

# Colors for output
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
NC='\033[0m' # No Color

# Test helper functions
test_start() {
    local test_name="$1"
    echo -n "Testing: $test_name ... "
    ((TESTS_RUN++))
}

test_pass() {
    echo -e "${GREEN}PASS${NC}"
    ((TESTS_PASSED++))
}

test_fail() {
    local reason="$1"
    echo -e "${RED}FAIL${NC} ($reason)"
    ((TESTS_FAILED++))
}

test_skip() {
    local reason="$1"
    echo -e "${YELLOW}SKIP${NC} ($reason)"
}

# Source utilities to test
source "$AETHER_ROOT/.aether/utils/vote-aggregator.sh"
source "$AETHER_ROOT/.aether/utils/issue-deduper.sh"
source "$AETHER_ROOT/.aether/utils/weight-calculator.sh"

# Create temporary test directory
TEST_DIR="$AETHER_ROOT/.aether/temp/voting_tests"
mkdir -p "$TEST_DIR/votes"

# ============================================================================
# TEST 1: Supermajority Calculation - Edge Cases
# ============================================================================
test_supermajority_edge_cases() {
    echo ""
    echo "=== Test Category: Supermajority Edge Cases ==="

    # Test 1.1: 4/4 APPROVE (100%) - should APPROVE
    test_start "4/4 APPROVE (100% >= 67%)"
    cat > "$TEST_DIR/votes/test_1_1.json" <<'EOF'
[
  {"watcher": "security", "decision": "APPROVE", "weight": 1.0, "issues": [], "timestamp": "2026-02-01T20:00:00Z"},
  {"watcher": "performance", "decision": "APPROVE", "weight": 1.0, "issues": [], "timestamp": "2026-02-01T20:00:00Z"},
  {"watcher": "quality", "decision": "APPROVE", "weight": 1.0, "issues": [], "timestamp": "2026-02-01T20:00:00Z"},
  {"watcher": "test_coverage", "decision": "APPROVE", "weight": 1.0, "issues": [], "timestamp": "2026-02-01T20:00:00Z"}
]
EOF
    result=$(calculate_supermajority "$TEST_DIR/votes/test_1_1.json" 2>&1)
    if echo "$result" | grep -q "APPROVED"; then
        test_pass
    else
        test_fail "Expected APPROVED, got: $result"
    fi

    # Test 1.2: 3/4 APPROVE (75%) - should APPROVE
    test_start "3/4 APPROVE (75% >= 67%)"
    cat > "$TEST_DIR/votes/test_1_2.json" <<'EOF'
[
  {"watcher": "security", "decision": "APPROVE", "weight": 1.0, "issues": [], "timestamp": "2026-02-01T20:00:00Z"},
  {"watcher": "performance", "decision": "APPROVE", "weight": 1.0, "issues": [], "timestamp": "2026-02-01T20:00:00Z"},
  {"watcher": "quality", "decision": "APPROVE", "weight": 1.0, "issues": [], "timestamp": "2026-02-01T20:00:00Z"},
  {"watcher": "test_coverage", "decision": "REJECT", "weight": 1.0, "issues": [], "timestamp": "2026-02-01T20:00:00Z"}
]
EOF
    result=$(calculate_supermajority "$TEST_DIR/votes/test_1_2.json" 2>&1)
    if echo "$result" | grep -q "APPROVED"; then
        test_pass
    else
        test_fail "Expected APPROVED, got: $result"
    fi

    # Test 1.3: 2/4 APPROVE (50%) - should REJECT
    test_start "2/4 APPROVE (50% < 67%)"
    cat > "$TEST_DIR/votes/test_1_3.json" <<'EOF'
[
  {"watcher": "security", "decision": "APPROVE", "weight": 1.0, "issues": [], "timestamp": "2026-02-01T20:00:00Z"},
  {"watcher": "performance", "decision": "APPROVE", "weight": 1.0, "issues": [], "timestamp": "2026-02-01T20:00:00Z"},
  {"watcher": "quality", "decision": "REJECT", "weight": 1.0, "issues": [], "timestamp": "2026-02-01T20:00:00Z"},
  {"watcher": "test_coverage", "decision": "REJECT", "weight": 1.0, "issues": [], "timestamp": "2026-02-01T20:00:00Z"}
]
EOF
    result=$(calculate_supermajority "$TEST_DIR/votes/test_1_3.json" 2>&1)
    if echo "$result" | grep -q "REJECTED"; then
        test_pass
    else
        test_fail "Expected REJECTED, got: $result"
    fi

    # Test 1.4: 1/4 APPROVE (25%) - should REJECT
    test_start "1/4 APPROVE (25% < 67%)"
    cat > "$TEST_DIR/votes/test_1_4.json" <<'EOF'
[
  {"watcher": "security", "decision": "APPROVE", "weight": 1.0, "issues": [], "timestamp": "2026-02-01T20:00:00Z"},
  {"watcher": "performance", "decision": "REJECT", "weight": 1.0, "issues": [], "timestamp": "2026-02-01T20:00:00Z"},
  {"watcher": "quality", "decision": "REJECT", "weight": 1.0, "issues": [], "timestamp": "2026-02-01T20:00:00Z"},
  {"watcher": "test_coverage", "decision": "REJECT", "weight": 1.0, "issues": [], "timestamp": "2026-02-01T20:00:00Z"}
]
EOF
    result=$(calculate_supermajority "$TEST_DIR/votes/test_1_4.json" 2>&1)
    if echo "$result" | grep -q "REJECTED"; then
        test_pass
    else
        test_fail "Expected REJECTED, got: $result"
    fi

    # Test 1.5: 0/4 APPROVE (0%) - should REJECT
    test_start "0/4 APPROVE (0% < 67%)"
    cat > "$TEST_DIR/votes/test_1_5.json" <<'EOF'
[
  {"watcher": "security", "decision": "REJECT", "weight": 1.0, "issues": [], "timestamp": "2026-02-01T20:00:00Z"},
  {"watcher": "performance", "decision": "REJECT", "weight": 1.0, "issues": [], "timestamp": "2026-02-01T20:00:00Z"},
  {"watcher": "quality", "decision": "REJECT", "weight": 1.0, "issues": [], "timestamp": "2026-02-01T20:00:00Z"},
  {"watcher": "test_coverage", "decision": "REJECT", "weight": 1.0, "issues": [], "timestamp": "2026-02-01T20:00:00Z"}
]
EOF
    result=$(calculate_supermajority "$TEST_DIR/votes/test_1_5.json" 2>&1)
    if echo "$result" | grep -q "REJECTED"; then
        test_pass
    else
        test_fail "Expected REJECTED, got: $result"
    fi
}

# ============================================================================
# TEST 2: Critical Veto Power
# ============================================================================
test_critical_veto() {
    echo ""
    echo "=== Test Category: Critical Veto Power ==="

    # Test 2.1: Critical issue blocks approval despite 3/4 APPROVE
    test_start "Critical issue blocks 3/4 APPROVE (veto)"
    cat > "$TEST_DIR/votes/test_2_1.json" <<'EOF'
[
  {"watcher": "security", "decision": "APPROVE", "weight": 1.0, "issues": [], "timestamp": "2026-02-01T20:00:00Z"},
  {"watcher": "performance", "decision": "APPROVE", "weight": 1.0, "issues": [], "timestamp": "2026-02-01T20:00:00Z"},
  {"watcher": "quality", "decision": "APPROVE", "weight": 1.0, "issues": [], "timestamp": "2026-02-01T20:00:00Z"},
  {"watcher": "test_coverage", "decision": "REJECT", "weight": 1.0, "issues": [
    {"severity": "Critical", "category": "test", "description": "No tests", "location": "test.py"}
  ], "timestamp": "2026-02-01T20:00:00Z"}
]
EOF
    result=$(calculate_supermajority "$TEST_DIR/votes/test_2_1.json" 2>&1)
    if echo "$result" | grep -q "REJECTED.*Critical veto"; then
        test_pass
    else
        test_fail "Expected Critical veto REJECT, got: $result"
    fi

    # Test 2.2: No Critical issue allows 3/4 APPROVE
    test_start "No Critical issue allows 3/4 APPROVE"
    cat > "$TEST_DIR/votes/test_2_2.json" <<'EOF'
[
  {"watcher": "security", "decision": "APPROVE", "weight": 1.0, "issues": [], "timestamp": "2026-02-01T20:00:00Z"},
  {"watcher": "performance", "decision": "APPROVE", "weight": 1.0, "issues": [], "timestamp": "2026-02-01T20:00:00Z"},
  {"watcher": "quality", "decision": "APPROVE", "weight": 1.0, "issues": [], "timestamp": "2026-02-01T20:00:00Z"},
  {"watcher": "test_coverage", "decision": "REJECT", "weight": 1.0, "issues": [
    {"severity": "High", "category": "test", "description": "Low coverage", "location": "test.py"}
  ], "timestamp": "2026-02-01T20:00:00Z"}
]
EOF
    result=$(calculate_supermajority "$TEST_DIR/votes/test_2_2.json" 2>&1)
    if echo "$result" | grep -q "APPROVED"; then
        test_pass
    else
        test_fail "Expected APPROVED, got: $result"
    fi
}

# ============================================================================
# TEST 3: Issue Deduplication
# ============================================================================
test_issue_deduping() {
    echo ""
    echo "=== Test Category: Issue Deduplication ==="

    # Test 3.1: Duplicate issues merged and tagged
    test_start "Duplicate issues merged with 'Multiple Watchers' tag"
    cat > "$TEST_DIR/votes/test_3_1.json" <<'EOF'
[
  {"watcher": "security", "decision": "REJECT", "weight": 1.0, "issues": [
    {"severity": "Critical", "category": "auth", "description": "Missing auth", "location": "app.py:10"}
  ], "timestamp": "2026-02-01T20:00:00Z"},
  {"watcher": "quality", "decision": "REJECT", "weight": 1.0, "issues": [
    {"severity": "Critical", "category": "auth", "description": "Missing auth", "location": "app.py:10"}
  ], "timestamp": "2026-02-01T20:00:00Z"}
]
EOF
    result=$(dedupe_and_prioritize "$TEST_DIR/votes/test_3_1.json")
    tag=$(echo "$result" | jq -r '.[0].tag')
    if [ "$tag" == "Multiple Watchers" ]; then
        test_pass
    else
        test_fail "Expected 'Multiple Watchers' tag, got: $tag"
    fi

    # Test 3.2: Issues sorted by severity (Critical first)
    test_start "Issues sorted by severity (Critical > High > Medium)"
    # (Implementation depends on issue-deduper.sh max_by logic)
    result=$(dedupe_and_prioritize "$TEST_DIR/votes/test_3_1.json")
    first_severity=$(echo "$result" | jq -r '.[0].severity')
    if [ "$first_severity" == "Critical" ]; then
        test_pass
    else
        test_fail "Expected Critical first, got: $first_severity"
    fi
}

# ============================================================================
# TEST 4: Weight Calculator
# ============================================================================
test_weight_calculator() {
    echo ""
    echo "=== Test Category: Weight Calculator ==="

    # Save original weights
    ORIGINAL_SECURITY=$(jq -r '.watcher_weights.security' "$AETHER_ROOT/.aether/data/watcher_weights.json")

    # Test 4.1: Correct approve increases weight
    test_start "Correct APPROVE increases weight (+0.1)"
    update_watcher_weight "security" "correct_approve" ""
    new_weight=$(jq -r '.watcher_weights.security' "$AETHER_ROOT/.aether/data/watcher_weights.json")
    expected=$(echo "$ORIGINAL_SECURITY + 0.1" | bc)
    if (( $(echo "$new_weight == $expected" | bc -l) )); then
        test_pass
    else
        test_fail "Expected $expected, got $new_weight"
    fi

    # Test 4.2: Correct reject increases weight more
    test_start "Correct REJECT increases weight (+0.15)"
    current=$(jq -r '.watcher_weights.security' "$AETHER_ROOT/.aether/data/watcher_weights.json")
    update_watcher_weight "security" "correct_reject" ""
    new_weight=$(jq -r '.watcher_weights.security' "$AETHER_ROOT/.aether/data/watcher_weights.json")
    expected=$(echo "$current + 0.15" | bc)
    if (( $(echo "$new_weight == $expected" | bc -l) )); then
        test_pass
    else
        test_fail "Expected $expected, got $new_weight"
    fi

    # Test 4.3: Incorrect approve decreases weight
    test_start "Incorrect APPROVE decreases weight (-0.2)"
    current=$(jq -r '.watcher_weights.security' "$AETHER_ROOT/.aether/data/watcher_weights.json")
    update_watcher_weight "security" "incorrect_approve" ""
    new_weight=$(jq -r '.watcher_weights.security' "$AETHER_ROOT/.aether/data/watcher_weights.json")
    expected=$(echo "$current - 0.2" | bc)
    if (( $(echo "$new_weight == $expected" | bc -l) )); then
        test_pass
    else
        test_fail "Expected $expected, got $new_weight"
    fi

    # Test 4.4: Weight clamped at minimum (0.1)
    test_start "Weight clamped at minimum (0.1)"
    # Set weight to 0.05, then apply -0.2 decrement
    jq '.watcher_weights.security = 0.05' "$AETHER_ROOT/.aether/data/watcher_weights.json" | sponge
    update_watcher_weight "security" "incorrect_approve" ""
    new_weight=$(jq -r '.watcher_weights.security' "$AETHER_ROOT/.aether/data/watcher_weights.json")
    if (( $(echo "$new_weight == 0.1" | bc -l) )); then
        test_pass
    else
        test_fail "Expected 0.1 (clamped), got $new_weight"
    fi

    # Test 4.5: Weight clamped at maximum (3.0)
    test_start "Weight clamped at maximum (3.0)"
    # Set weight to 2.95, then apply +0.15 increment
    jq '.watcher_weights.security = 2.95' "$AETHER_ROOT/.aether/data/watcher_weights.json" | sponge
    update_watcher_weight "security" "correct_reject" ""
    new_weight=$(jq -r '.watcher_weights.security' "$AETHER_ROOT/.aether/data/watcher_weights.json")
    if (( $(echo "$new_weight == 3.0" | bc -l) )); then
        test_pass
    else
        test_fail "Expected 3.0 (clamped), got $new_weight"
    fi

    # Test 4.6: Domain expertise bonus (×2)
    test_start "Domain expertise bonus applied (×2)"
    jq '.watcher_weights.security = 1.0' "$AETHER_ROOT/.aether/data/watcher_weights.json" | sponge
    update_watcher_weight "security" "correct_approve" "security"
    new_weight=$(jq -r '.watcher_weights.security' "$AETHER_ROOT/.aether/data/watcher_weights.json")
    # (1.0 + 0.1) * 2 = 2.2
    expected="2.2"
    if (( $(echo "$new_weight == $expected" | bc -l) )); then
        test_pass
    else
        test_fail "Expected $expected (with domain bonus), got $new_weight"
    fi

    # Restore original weight
    jq ".watcher_weights.security = $ORIGINAL_SECURITY" "$AETHER_ROOT/.aether/data/watcher_weights.json" | sponge
}

# ============================================================================
# TEST 5: Vote Recording
# ============================================================================
test_vote_recording() {
    echo ""
    echo "=== Test Category: Vote Recording ==="

    # Test 5.1: Vote recorded in COLONY_STATE.json
    test_start "Vote recorded in COLONY_STATE.json verification.votes"
    verification_id="test_verification_$(date +%s)"
    record_vote_outcome "security" "APPROVE" "[]" "$verification_id"
    vote_count=$(jq -r ".verification.votes | map(select(.id == \"$verification_id\")) | length" "$AETHER_ROOT/.aether/data/COLONY_STATE.json")
    if [ "$vote_count" -eq 1 ]; then
        test_pass
    else
        test_fail "Expected 1 vote recorded, got $vote_count"
    fi

    # Test 5.2: Vote outcome set to "pending"
    test_start "Vote outcome set to 'pending'"
    outcome=$(jq -r ".verification.votes[] | select(.id == \"$verification_id\") | .outcome" "$AETHER_ROOT/.aether/data/COLONY_STATE.json")
    if [ "$outcome" == "pending" ]; then
        test_pass
    else
        test_fail "Expected 'pending', got $outcome"
    fi
}

# ============================================================================
# MAIN TEST RUNNER
# ============================================================================
main() {
    echo "=========================================="
    echo "Aether Voting System Test Suite"
    echo "=========================================="
    echo ""

    # Run all test categories
    test_supermajority_edge_cases
    test_critical_veto
    test_issue_deduping
    test_weight_calculator
    test_vote_recording

    # Print summary
    echo ""
    echo "=========================================="
    echo "Test Summary"
    echo "=========================================="
    echo "Tests Run:    $TESTS_RUN"
    echo -e "Tests Passed: ${GREEN}$TESTS_PASSED${NC}"
    echo -e "Tests Failed: ${RED}$TESTS_FAILED${NC}"
    echo ""

    if [ $TESTS_FAILED -eq 0 ]; then
        echo -e "${GREEN}All tests passed!${NC}"
        exit 0
    else
        echo -e "${RED}Some tests failed.${NC}"
        exit 1
    fi
}

# Run tests
main
```

**Key test categories:**
1. **Supermajority Edge Cases**: 0/4, 1/4, 2/4, 3/4, 4/4 APPROVE scenarios
2. **Critical Veto Power**: Critical issue blocks approval, High severity doesn't
3. **Issue Deduplication**: Duplicate merging, "Multiple Watchers" tag, severity sorting
4. **Weight Calculator**: Asymmetric updates, clamping at bounds, domain bonus
5. **Vote Recording**: COLONY_STATE.json storage, outcome="pending"

**Test file locations:**
- Test votes: $TEST_DIR/votes/test_*.json
- Temporary directory: .aether/temp/voting_tests
- Cleaned up after tests (optional)

**Follows test-spawning-safeguards.sh pattern:**
- Similar structure (test_start, test_pass, test_fail, test_skip)
- Color-coded output (GREEN/RED/YELLOW)
- Test counters and summary
- Exit code 0 on success, 1 on failure
  </action>
  <verify>
bash -n .aether/utils/test-voting-system.sh && echo "Syntax valid"
chmod +x .aether/utils/test-voting-system.sh
  </verify>
  <done>test-voting-system.sh created with 5 test categories (supermajority edge cases, Critical veto, issue deduping, weight calculator, vote recording), follows test-spawning-safeguards.sh pattern</done>
</task>

<task type="auto">
  <name>Task 2: Run voting system tests and verify all pass</name>
  <files>.aether/utils/test-voting-system.sh</files>
  <action>
Run the test suite and verify all tests pass:

```bash
# Run voting system tests
bash .aether/utils/test-voting-system.sh
```

Expected output:
- All tests pass (GREEN)
- Test summary shows:
  - Tests Run: ~15-20 tests
  - Tests Passed: all
  - Tests Failed: 0
- Exit code: 0

If any tests fail:
1. Review failure reason in test output
2. Fix underlying issue in utilities (vote-aggregator.sh, issue-deduper.sh, weight-calculator.sh)
3. Re-run tests until all pass
4. Document any intentional deviations in test comments

Common test failures and fixes:
- **Supermajority calculation fails**: Check bc floating-point precision, check jq query syntax
- **Critical veto fails**: Check veto logic runs BEFORE supermajority calculation
- **Issue deduping fails**: Check fingerprint generation, check jq group_by logic
- **Weight clamping fails**: Check bc comparison logic, verify bounds [0.1, 3.0]
- **Vote recording fails**: Check atomic_write, verify COLONY_STATE.json has verification section

After all tests pass, document test count in PLAN.md SUMMARY.
  </action>
  <verify>
bash .aether/utils/test-voting-system.sh && echo "All tests passed" || echo "Tests failed"
  </verify>
  <done>All voting system tests pass (15-20 tests, 0 failures), voting system verified correct</done>
</task>

</tasks>

<verification>
1. Test suite created and executable:
   - test-voting-system.sh exists
   - Shebang is #!/bin/bash
   - File is executable (chmod +x)

2. All 5 test categories implemented:
   - Supermajority edge cases (5 tests: 0/4, 1/4, 2/4, 3/4, 4/4)
   - Critical veto power (2 tests)
   - Issue deduplication (2 tests)
   - Weight calculator (6 tests)
   - Vote recording (2 tests)

3. Test suite runs and passes:
   - bash .aether/utils/test-voting-system.sh exits with code 0
   - Output shows "All tests passed"
   - No test failures reported

4. Integration with existing utilities:
   - Sources vote-aggregator.sh
   - Sources issue-deduper.sh
   - Sources weight-calculator.sh
   - Uses watcher_weights.json
   - Updates COLONY_STATE.json

5. Cleanup:
   - Temporary test files cleaned up
   - Original watcher_weights.json restored after weight tests
</verification>

<success_criteria>
1. test-voting-system.sh created with comprehensive test coverage
2. 15-20 tests covering all voting system components
3. All tests pass (100% pass rate)
4. Supermajority calculation verified (all 5 edge cases)
5. Critical veto verified (blocks approval, doesn't over-veto)
6. Issue deduping verified (merges duplicates, tags correctly)
7. Weight calculator verified (asymmetric updates, clamping, domain bonus)
8. Vote recording verified (COLONY_STATE.json, outcome=pending)
9. Wave 4 complete, Phase 7 ready for completion
</success_criteria>

<output>
After completion, create `.planning/phases/07-colony-verification---multi-perspective-verification-with-weighted-voting-and-belief-calibration/07-05-SUMMARY.md` with:
- Test suite created and passing
- All voting system components verified
- Wave 4 complete, Phase 7 complete (all 5 waves done)
- Ready for Phase 8 (Colony Learning with Bayesian confidence)
</output>
