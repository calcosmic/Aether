---
phase: 36-signal-simplification
plan: 05
type: execute
wave: 1
depends_on: []
files_modified:
  - commands/ant/plan.md
  - commands/ant/organize.md
  - commands/ant/colonize.md
  - runtime/workers/builder-ant.md
  - runtime/workers/watcher-ant.md
  - runtime/workers/scout-ant.md
  - runtime/workers/colonizer-ant.md
  - runtime/workers/architect-ant.md
  - runtime/workers/route-setter-ant.md
autonomous: true
gap_closure: true

must_haves:
  truths:
    - "plan.md uses TTL filtering instead of pheromone-batch"
    - "organize.md uses TTL filtering instead of pheromone-batch"
    - "colonize.md uses TTL filtering instead of pheromone-batch"
    - "runtime/workers/*.md files are deleted (replaced by .aether/workers.md)"
  artifacts:
    - path: "commands/ant/plan.md"
      provides: "TTL-based signal filtering"
      contains: "expires_at|priority"
    - path: "commands/ant/organize.md"
      provides: "TTL-based signal filtering"
      contains: "expires_at|priority"
    - path: "commands/ant/colonize.md"
      provides: "TTL-based signal filtering"
      contains: "expires_at|priority"
  key_links:
    - from: "commands/ant/plan.md"
      to: ".aether/data/pheromones.json"
      via: "direct read with filtering"
      pattern: "expires_at"
---

<objective>
Update remaining commands to use TTL filtering and delete obsolete runtime/workers/*.md files.

Purpose: Close verification gaps -- commands still call pheromone-batch, workers files duplicate .aether/workers.md
Output: Commands use TTL filtering, obsolete worker files deleted
</objective>

<execution_context>
@~/.claude/cosmic-dev-system/workflows/execute-plan.md
@~/.claude/cosmic-dev-system/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/36-signal-simplification/36-VERIFICATION.md

Reference files:
@commands/ant/plan.md
@commands/ant/organize.md
@commands/ant/colonize.md
@.aether/workers.md (the consolidated replacement)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Update plan.md, organize.md, colonize.md to use TTL filtering</name>
  <files>commands/ant/plan.md, commands/ant/organize.md, commands/ant/colonize.md</files>
  <action>
For each of the three command files, replace the pheromone-batch call with inline TTL filtering:

**plan.md (Step 3 around line 33):**

Remove:
```
bash ~/.aether/aether-utils.sh pheromone-batch
```

Replace with direct pheromones.json read and filter:
```
Read `.aether/data/pheromones.json` and filter the signals array:
- For each signal:
  - If expires_at == "phase_end": keep (phase-scoped)
  - If expires_at is a timestamp and expires_at < current_time: skip (expired)
  - Otherwise: keep

Format active signals as:
ACTIVE SIGNALS:
  {TYPE} [{priority}]: "{content}" ({expires display})

Where expires display is:
- "phase" if expires_at == "phase_end"
- "Xm left" / "Xh left" for wall-clock expiration
```

Remove the strength-based filtering (`current_strength < 0.05`) and strength display format.

**organize.md (Step 2 around line 29):**

Same pattern - replace pheromone-batch call with direct read + TTL filter.

Remove:
```
bash ~/.aether/aether-utils.sh pheromone-batch
```

Replace the strength-based display format:
```
{TYPE padded to 10 chars} [{bar}] {current_strength:.2f}
  "{content}"
```

With priority-based format:
```
{TYPE} [{priority}]: "{content}" ({time remaining or "phase"})
```

**colonize.md (Step 2 around line 31):**

Same pattern - replace pheromone-batch call with direct read + TTL filter.

Remove the strength-based display format and replace with priority-based format.

**For all three files:**
- Remove any references to `current_strength` or strength thresholds (0.05)
- Remove strength bar displays
- Use priority (high/normal/low) instead of strength (0.0-1.0)
- Signal type interpretation remains the same: REDIRECT = constraint, FOCUS = priority area
  </action>
  <verify>Run these checks:
1. `grep "pheromone-batch" commands/ant/plan.md` should return nothing
2. `grep "pheromone-batch" commands/ant/organize.md` should return nothing
3. `grep "pheromone-batch" commands/ant/colonize.md` should return nothing
4. `grep "current_strength" commands/ant/plan.md` should return nothing
5. `grep "expires_at\|priority" commands/ant/plan.md` should find matches</verify>
  <done>All three commands use TTL filtering with priority-based display instead of pheromone-batch</done>
</task>

<task type="auto">
  <name>Task 2: Delete obsolete runtime/workers/*.md files</name>
  <files>runtime/workers/builder-ant.md, runtime/workers/watcher-ant.md, runtime/workers/scout-ant.md, runtime/workers/colonizer-ant.md, runtime/workers/architect-ant.md, runtime/workers/route-setter-ant.md</files>
  <action>
Delete all 6 worker spec files from runtime/workers/:

```bash
rm runtime/workers/builder-ant.md
rm runtime/workers/watcher-ant.md
rm runtime/workers/scout-ant.md
rm runtime/workers/colonizer-ant.md
rm runtime/workers/architect-ant.md
rm runtime/workers/route-setter-ant.md
```

Also delete the runtime/workers/ directory if it becomes empty:
```bash
rmdir runtime/workers/
```

**Why:** These files contain sensitivity matrices and pheromone-effective calls that use the old decay system. Phase 35 created `.aether/workers.md` as the consolidated replacement with priority-based guidance. The runtime/workers/ files are obsolete duplicates.

**Note:** Commands that reference worker specs (like plan.md, colonize.md) reference `~/.aether/workers/*.md` paths, which are symlinked to `.aether/workers/` in the project. The consolidated `.aether/workers.md` file is the canonical source.
  </action>
  <verify>Run these checks:
1. `ls runtime/workers/*.md 2>/dev/null | wc -l` should return 0
2. `test -d runtime/workers && echo "exists" || echo "deleted"` should return "deleted"
3. `test -f .aether/workers.md && echo "exists"` should return "exists" (consolidated file still present)</verify>
  <done>All 6 obsolete runtime/workers/*.md files deleted, runtime/workers/ directory removed</done>
</task>

</tasks>

<verification>
After both tasks complete:

1. No pheromone-batch calls in commands:
   - `grep -r "pheromone-batch" commands/ant/` should return nothing

2. No strength-based filtering:
   - `grep -r "current_strength" commands/ant/{plan,organize,colonize}.md` should return nothing

3. TTL filtering present:
   - `grep -l "expires_at" commands/ant/{plan,organize,colonize}.md` should find all three

4. Obsolete worker files deleted:
   - `ls runtime/workers/*.md 2>/dev/null` should return nothing

5. Consolidated worker file exists:
   - `.aether/workers.md` should exist with priority-based guidance
</verification>

<success_criteria>
- plan.md, organize.md, colonize.md use TTL filtering (no pheromone-batch)
- No strength-based display or filtering in these commands
- All 6 runtime/workers/*.md files deleted
- runtime/workers/ directory removed
- .aether/workers.md still exists as canonical source
</success_criteria>

<output>
After completion, create `.planning/phases/36-signal-simplification/36-05-SUMMARY.md`
</output>
