---
phase: 14-visual-identity
plan: 02
type: execute
wave: 2
depends_on: ["14-01"]
files_modified:
  - .claude/commands/ant/status.md
  - .claude/commands/ant/build.md
  - .claude/commands/ant/resume-colony.md
  - .claude/commands/ant/pause-colony.md
autonomous: true

must_haves:
  truths:
    - "Running /ant:status shows each active pheromone with a 20-character decay strength bar and numeric value"
    - "Running /ant:status shows workers grouped by status (active/idle/error) with emoji indicators"
    - "When all workers are idle, status shows compact summary instead of listing each worker"
    - "Running /ant:build shows pheromone signals with decay strength bars in Step 3 output"
    - "Running /ant:resume-colony shows pheromone decay bars and worker grouping in restored state display"
    - "Running /ant:pause-colony shows visual formatting in the pause confirmation"
    - "Pheromone display handles empty state: shows '(no active pheromones)' when none active"
  artifacts:
    - path: ".claude/commands/ant/status.md"
      provides: "Pheromone decay bar template and worker status grouping"
      contains: "round(current_strength"
    - path: ".claude/commands/ant/build.md"
      provides: "Pheromone decay bar in active pheromones display"
      contains: "round(current_strength"
    - path: ".claude/commands/ant/resume-colony.md"
      provides: "Pheromone decay bars and worker grouping in restored state"
      contains: "round(current_strength"
    - path: ".claude/commands/ant/pause-colony.md"
      provides: "Visual formatting in pause confirmation"
      contains: "AETHER COLONY"
  key_links:
    - from: ".claude/commands/ant/status.md"
      to: ".aether/data/pheromones.json"
      via: "Read tool to get signals, compute decay, render bars"
      pattern: "e\\^\\(-0\\.693"
    - from: ".claude/commands/ant/status.md"
      to: ".aether/data/COLONY_STATE.json"
      via: "Read tool to get workers object, group by status"
      pattern: "workers.*status"
---

<objective>
Add pheromone decay strength bar rendering and worker activity grouping to status-displaying commands.

Purpose: Complete the visual identity by making pheromone signals and worker status scannable at a glance. Currently pheromones show as plain text with numeric strength; workers are listed flat without grouping (VIS-03, VIS-04).

Output: 4 modified command files with pheromone decay bar templates and worker status grouping.
</objective>

<execution_context>
@~/.claude/cosmic-dev-system/workflows/execute-plan.md
@~/.claude/cosmic-dev-system/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/14-visual-identity/14-RESEARCH.md
@.planning/phases/14-visual-identity/14-01-SUMMARY.md

Plan 14-01 added box-drawing headers and step progress to the 5 major commands. This plan adds the second layer: pheromone decay bars and worker grouping to the 4 commands that display pheromone/worker information.

Key constraint: These are Claude-native prompt files. Add output template instructions, not code. Claude computes decay strength inline using the formula already present in these commands.

Anti-patterns to avoid:
- Do NOT add pheromone bars without the numeric strength value alongside
- Do NOT use emojis without text labels (accessibility)
- Do NOT forget the empty-state case (no active signals -> display "(no active pheromones)")
- Do NOT duplicate long template blocks across files -- status.md gets the full template; others get concise versions
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add pheromone decay bars and worker grouping to status.md</name>
  <files>
    .claude/commands/ant/status.md
  </files>
  <action>
status.md is the primary visual command. It gets the most detailed pheromone and worker display templates.

**Pheromone decay bars** -- In Step 2/3 where pheromone display happens, replace the current simple format with a bar-based display. After the existing decay computation instructions, add the display template:

```
For each non-expired signal, display with a visual strength bar:

  {TYPE padded to 10 chars} [{bar}] {current_strength:.2f}
    "{content}"

Where the bar has 20 characters total:
- Filled portion: repeat the character "=" for round(current_strength * 20) times
- Empty portion: fill remaining with spaces
- Wrap in square brackets

Examples:
  INIT       [====================] 1.00  (persistent)
    "Build a REST API with authentication"
  FOCUS      [===============     ] 0.75
    "WebSocket security"
  REDIRECT   [======              ] 0.30
    "Don't use JWT for sessions"

If no active signals after filtering:
  (no active pheromones)
```

**Worker status grouping** -- Replace the current flat worker list in Step 3 with grouped display:

```
Display workers grouped by their status from COLONY_STATE.json:

WORKERS

If ALL workers have "idle" status (the common case), display a compact summary:
  All 6 workers idle -- colony ready

Otherwise, group by status with emoji + text label:

  Active:
    [ant emoji] <worker_name>: currently executing

  Idle:
    [white circle emoji] <worker_name>, <worker_name>, ...

  Error:
    [red circle emoji] <worker_name>: <error detail if available>

Summary line at the end:
  [ant emoji] <N> active | [white circle emoji] <N> idle | [red circle emoji] <N> error
```

IMPORTANT: Preserve the existing pheromone decay COMPUTATION instructions (the formula). Only change the DISPLAY format. The computation logic (half_life_seconds, e^(-0.693 * ...), 0.05 threshold) stays exactly as is.
  </action>
  <verify>
Read status.md and confirm:
1. Pheromone display includes bar template with 20-char width and numeric value
2. Bar template shows examples with different strength levels
3. Empty-state handled: "(no active pheromones)"
4. Worker grouping shows compact format for all-idle case
5. Worker grouping shows expanded format with emoji+text for mixed statuses
6. Original decay computation formula preserved
7. Box-drawing header from Plan 14-01 is still present
  </verify>
  <done>
status.md shows pheromone signals with 20-character decay strength bars and numeric values, and workers grouped by status with emoji indicators. Compact display for all-idle case, expanded for mixed statuses.
  </done>
</task>

<task type="auto">
  <name>Task 2: Add pheromone decay bars to build.md, resume-colony.md, and pause-colony.md</name>
  <files>
    .claude/commands/ant/build.md
    .claude/commands/ant/resume-colony.md
    .claude/commands/ant/pause-colony.md
  </files>
  <action>
These commands also display pheromone information. Add concise decay bar templates (not the full verbose version from status.md).

**build.md** -- In Step 3 (Compute Active Pheromones), replace the current plain format block with a bar-based display:

Replace:
```
ACTIVE PHEROMONES:
- {TYPE} (strength {current_strength:.2f}): "{content}"
```

With:
```
ACTIVE PHEROMONES:
  {TYPE padded to 10 chars} [{bar of 20 chars using "=" filled, spaces empty}] {current_strength:.2f}
    "{content}"

If no active signals: (no active pheromones)
```

Keep the computation instructions (steps 1-3) exactly as they are. Only change the display format.

Also add a simple header to Step 7 (Display Results) if not already present from Plan 14-01. The header and step progress should already be there from Plan 14-01; just verify they are.

**resume-colony.md** -- In Step 3 (Display Restored State), enhance the pheromone display section:

Replace the current:
```
  <TYPE> (strength <current:.2f>): "<content>"
```

With bar-based display:
```
  {TYPE padded to 10 chars} [{bar of 20 chars}] {current_strength:.2f}
    "{content}"
```

Also add worker grouping to the restored state display. After the ACTIVE PHEROMONES section, add:

```
WORKERS
  (Use same grouping as status.md: compact "All 6 workers idle -- colony ready" if all idle, otherwise group by active/idle/error with emoji + text labels)
```

Add a simple box-drawing header to the "COLONY RESUMED" display:
```
+=====================================================+
|  AETHER COLONY :: RESUMED                            |
+=====================================================+
```

**pause-colony.md** -- In Step 5 (Display Confirmation), add a simple header:

```
+=====================================================+
|  AETHER COLONY :: PAUSED                             |
+=====================================================+
```

Keep the existing confirmation content. This command does not need full pheromone bars since it just reports count, but the header gives visual consistency.

IMPORTANT: Preserve ALL existing logic and content in each file. Only modify display/output template sections.
  </action>
  <verify>
Read each modified file and confirm:
1. build.md Step 3 shows pheromone bars with 20-char width format
2. build.md preserves decay computation formula and all spawn logic
3. resume-colony.md shows pheromone bars and worker grouping in restored state
4. resume-colony.md has box-drawing header
5. pause-colony.md has box-drawing header in confirmation display
6. All original logic (state reading, pheromone computation, handoff writing) preserved
7. Empty-state handling present for pheromone displays
  </verify>
  <done>
build.md shows pheromone signals with decay strength bars. resume-colony.md shows decay bars and worker grouping in restored state display with a header. pause-colony.md has a header in its confirmation display. All original logic preserved.
  </done>
</task>

</tasks>

<verification>
After both tasks complete:
1. Read all 4 modified files and confirm pheromone bar templates are present
2. Confirm status.md has both pheromone bars AND worker grouping
3. Confirm empty-state handling ("no active pheromones") in all pheromone displays
4. Confirm worker grouping handles the all-idle case compactly
5. Confirm emojis are paired with text labels (accessibility)
6. Confirm no original computation logic, state reading, or command flow was altered
7. Confirm resume-colony.md and pause-colony.md have box-drawing headers
</verification>

<success_criteria>
- Pheromone signals display with 20-char decay strength bars and numeric values in status, build, and resume-colony commands (VIS-03)
- Workers grouped by status with emoji+text indicators in status and resume-colony (VIS-04)
- All-idle case shows compact summary, mixed shows expanded grouped display
- Empty-state handled for all pheromone displays
- resume-colony.md and pause-colony.md have box-drawing headers for visual consistency
- All original command logic and flow preserved unchanged
</success_criteria>

<output>
After completion, create `.planning/phases/14-visual-identity/14-02-SUMMARY.md`
</output>
