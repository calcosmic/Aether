---
phase: 03-pheromone-communication
plan: 04
type: execute
wave: 2
depends_on: [03-01, 03-02, 03-03]
files_modified:
  - .aether/workers/colonizer-ant.md
  - .aether/workers/route-setter-ant.md
  - .aether/workers/builder-ant.md
autonomous: true
user_setup: []

must_haves:
  truths:
    - "Colonizer Ant reads pheromones.json and interprets signals"
    - "Route-setter Ant reads pheromones.json and interprets signals"
    - "Builder Ant reads pheromones.json and interprets signals"
    - "Each Ant calculates effective strength (signal × sensitivity)"
    - "Each Ant adjusts behavior based on pheromone combinations"
  artifacts:
    - path: ".aether/workers/colonizer-ant.md"
      provides: "Colonizer Ant pheromone response logic"
      contains: "Pheromone reading and interpretation section"
    - path: ".aether/workers/route-setter-ant.md"
      provides: "Route-setter Ant pheromone response logic"
      contains: "Pheromone reading and interpretation section"
    - path: ".aether/workers/builder-ant.md"
      provides: "Builder Ant pheromone response logic"
      contains: "Pheromone reading and interpretation section"
  key_links:
    - from: ".aether/workers/*-ant.md"
      to: ".aether/data/pheromones.json"
      via: "Worker Ant reads active_pheromones array on task start"
      pattern: "cat.*pheromones\\.json|jq.*active_pheromones"
    - from: ".aether/workers/*-ant.md"
      to: ".aether/data/worker_ants.json"
      via: "Worker Ant reads own sensitivity_profile"
      pattern: "sensitivity_profile"
---

<objective>
Update Colonizer, Route-setter, and Builder Ant prompts to read and respond to pheromone signals.

Purpose: Enable Worker Ants to interpret pheromone signals, calculate effective strength, and adjust behavior based on caste-specific sensitivities
Output: Three Worker Ant prompts with pheromone reading and interpretation instructions
</objective>

<execution_context>
@~/.claude/cosmic-dev-system/workflows/execute-plan.md
@~/.claude/cosmic-dev-system/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.aether/data/pheromones.json
@.aether/data/worker_ants.json
@.aether/workers/builder-ant.md
@.planning/phases/03-pheromone-communication/03-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add pheromone response section to Colonizer Ant</name>
  <files>.aether/workers/colonizer-ant.md</files>
  <action>
    Add a new section "## Read Active Pheromones" after "## Your Sensitivity Profile" with the following content:

    ```markdown
    ## Read Active Pheromones

    Before starting work, read current pheromone signals:

    \`\`\`bash
    # Read pheromones
    cat .aether/data/pheromones.json
    \`\`\`

    ## Interpret Pheromone Signals

    Your caste (colonizer) has these sensitivities:
    - INIT: 1.0 - Respond when codebase colonization is needed
    - FOCUS: 0.8 - Prioritize focused areas in colonization
    - REDIRECT: 0.9 - Strongly avoid redirected patterns
    - FEEDBACK: 0.7 - Adjust colonization based on feedback

    For each active pheromone:

    1. **Calculate decay**:
       - INIT: No decay (persists until phase complete)
       - FOCUS: strength × 0.5^((now - created_at) / 3600)
       - REDIRECT: strength × 0.5^((now - created_at) / 86400)
       - FEEDBACK: strength × 0.5^((now - created_at) / 21600)

    2. **Calculate effective strength**:
       \`\`\`
       effective = decayed_strength × your_sensitivity
       \`\`\`

    3. **Respond if effective > 0.1**:
       - FOCUS > 0.5: Colonize focused area first
       - REDIRECT > 0.5: Avoid pattern completely
       - FEEDBACK > 0.3: Adjust colonization approach

    Example calculation:
      FOCUS "WebSocket security" created 30min ago
      - strength: 0.7
      - hours: 0.5
      - decay: 0.5^0.5 = 0.707
      - current: 0.7 × 0.707 = 0.495
      - colonizer sensitivity: 0.8
      - effective: 0.495 × 0.8 = 0.396
      - Action: Include in colonization (0.396 > 0.3 threshold)

    ## Pheromone Combinations

    When multiple pheromones are active, combine their effects:

    FOCUS + FEEDBACK (same topic):
    - Positive feedback: Increase prioritization
    - Quality feedback: Add extra analysis to focused area
    - Direction feedback: Pivot colonization focus

    INIT + REDIRECT:
    - Goal established, but avoid specific approaches
    - Colonize alternative paths to goal
    - Document constraints in working memory

    Multiple FOCUS signals:
    - Prioritize by effective strength (signal × sensitivity)
    - Colonize highest-strength focus first
    - Note lower-priority focuses for later
    ```

    This content should be inserted after the sensitivity profile table and before "## Your Workflow".
  </action>
  <verify>
    1. Read .aether/workers/colonizer-ant.md
    2. Verify "## Read Active Pheromones" section exists
    3. Verify decay calculation formulas are present
    4. Verify effective strength formula is present
    5. Verify pheromone combinations section exists
  </verify>
  <done>Colonizer Ant has pheromone reading instructions and can adjust colonization based on signals</done>
</task>

<task type="auto">
  <name>Task 2: Add pheromone response section to Route-setter Ant</name>
  <files>.aether/workers/route-setter-ant.md</files>
  <action>
    Add the same "## Read Active Pheromones" section to Route-setter Ant, with caste-specific sensitivities:

    Your caste (route_setter) has these sensitivities:
    - INIT: 1.0 - Respond when phase planning is needed
    - FOCUS: 0.9 - Incorporate focused areas into plans
    - REDIRECT: 0.8 - Avoid redirected patterns in planning
    - FEEDBACK: 0.8 - Adjust plans based on feedback

    Use the same decay calculation, effective strength formula, and pheromone combinations sections.

    Example calculation should show:
      FOCUS "WebSocket security" created 30min ago
      - effective: 0.495 × 0.9 = 0.446 (route_setter sensitivity)
      - Action: Include in early phase tasks (0.446 > 0.3 threshold)

    This content should be inserted after the sensitivity profile table.
  </action>
  <verify>
    1. Read .aether/workers/route-setter-ant.md
    2. Verify "## Read Active Pheromones" section exists
    3. Verify route_setter sensitivity values are correct (INIT 1.0, FOCUS 0.9, REDIRECT 0.8, FEEDBACK 0.8)
    4. Verify decay and effective strength formulas present
  </verify>
  <done>Route-setter Ant has pheromone reading instructions and can adjust planning based on signals</done>
</task>

<task type="auto">
  <name>Task 3: Add pheromone response section to Builder Ant</name>
  <files>.aether/workers/builder-ant.md</files>
  <action>
    Add the same "## Read Active Pheromones" section to Builder Ant, with caste-specific sensitivities:

    Your caste (builder) has these sensitivities:
    - INIT: 0.9 - Respond when implementation is needed
    - FOCUS: 1.0 - Highly responsive, prioritize focused areas
    - REDIRECT: 0.7 - Avoid redirected patterns
    - FEEDBACK: 0.9 - Adjust approach based on feedback

    Use the same decay calculation, effective strength formula, and pheromone combinations sections.

    Example calculation should show:
      FOCUS "WebSocket security" created 30min ago
      - effective: 0.495 × 1.0 = 0.495 (builder sensitivity)
      - Action: Prioritize immediately (0.495 > 0.3 threshold)

    This content should be inserted after the sensitivity profile table (after line 25).
  </action>
  <verify>
    1. Read .aether/workers/builder-ant.md
    2. Verify "## Read Active Pheromones" section exists
    3. Verify builder sensitivity values are correct (INIT 0.9, FOCUS 1.0, REDIRECT 0.7, FEEDBACK 0.9)
    4. Verify decay and effective strength formulas present
  </verify>
  <done>Builder Ant has pheromone reading instructions and can adjust implementation based on signals</done>
</task>

</tasks>

<verification>
After completion, verify:
1. All three Worker Ant prompts have "## Read Active Pheromones" section
2. Each caste has correct sensitivity values from worker_ants.json
3. Decay calculation formulas are present for all pheromone types
4. Effective strength calculation (signal × sensitivity) is documented
5. Pheromone combination logic is documented
6. Response thresholds (>0.1, >0.3, >0.5) are specified
</verification>

<success_criteria>
Colonizer, Route-setter, and Builder Ants can read pheromones.json, calculate effective strength based on their caste sensitivity, and adjust their behavior accordingly
</success_criteria>

<output>
After completion, create `.planning/phases/03-pheromone-communication/03-04-SUMMARY.md`
</output>
