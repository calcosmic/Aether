---
phase: 03-pheromone-communication
plan: 06
type: execute
wave: 3
depends_on: [03-01, 03-02, 03-03, 03-04, 03-05]
files_modified: []
autonomous: false
user_setup: []

must_haves:
  truths:
    - "All pheromone commands execute successfully"
    - "All Worker Ant prompts have pheromone reading instructions"
    - "Pheromone signals appear in pheromones.json with correct decay rates"
    - "Worker Ants can interpret signals based on caste sensitivity"
    - "Effective strength calculation works (signal × sensitivity)"
  artifacts:
    - path: ".claude/commands/ant/focus.md"
      provides: "FOCUS pheromone emission"
      verified: "Command executes and creates pheromone"
    - path: ".claude/commands/ant/redirect.md"
      provides: "REDIRECT pheromone emission"
      verified: "Command executes and creates pheromone"
    - path: ".claude/commands/ant/feedback.md"
      provides: "FEEDBACK pheromone emission"
      verified: "Command executes and creates pheromone"
    - path: ".aether/workers/*-ant.md"
      provides: "Pheromone response logic"
      verified: "All 6 castes have reading instructions"
  key_links:
    - from: "Queen commands"
      to: "pheromones.json"
      via: "jq append to active_pheromones"
      verified: "Commands create pheromone objects"
    - from: "Worker Ant prompts"
      to: "pheromones.json"
      via: "cat pheromones.json"
      verified: "Prompts include reading instructions"
---

<objective>
Verify end-to-end pheromone communication system functionality.

Purpose: Confirm all components of Phase 3 work together - commands emit signals, Worker Ants read and interpret signals
Output: Verified pheromone communication system ready for Phase 4
</objective>

<execution_context>
@~/.claude/cosmic-dev-system/workflows/execute-plan.md
@~/.claude/cosmic-dev-system/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.aether/data/pheromones.json
@.aether/data/worker_ants.json
@.planning/phases/03-pheromone-communication/03-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Verify pheromone command implementations</name>
  <files>.claude/commands/ant/focus.md, .claude/commands/ant/redirect.md, .claude/commands/ant/feedback.md</files>
  <action>
    Review the three pheromone command files and verify:

    1. **All commands follow init.md pattern**:
       - Input validation
       - jq to create pheromone object
       - Atomic write via .aether/utils/atomic-write.sh
       - Formatted ASCII output

    2. **Correct decay rates**:
       - FOCUS: decay_rate 3600 (1 hour)
       - REDIRECT: decay_rate 86400 (24 hours)
       - FEEDBACK: decay_rate 21600 (6 hours)

    3. **Correct default strengths**:
       - FOCUS: strength 0.7
       - REDIRECT: strength 0.9
       - FEEDBACK: strength 0.5

    4. **No Python code**: All bash/jq implementation

    Create a verification report listing each command's conformance to the pattern.
  </action>
  <verify>
    1. Read .claude/commands/ant/focus.md
    2. Read .claude/commands/ant/redirect.md
    3. Read .claude/commands/ant/feedback.md
    4. Verify all use jq for JSON manipulation
    5. Verify all use atomic-write.sh
    6. Verify decay rates match requirements
  </verify>
  <done>All three pheromone commands follow init.md pattern with correct decay rates and strengths</done>
</task>

<task type="auto">
  <name>Task 2: Verify Worker Ant pheromone response implementations</name>
  <files>.aether/workers/*.md</files>
  <action>
    Review all six Worker Ant prompts and verify:

    1. **All have "## Read Active Pheromones" section**

    2. **Correct sensitivity values** (from worker_ants.json):
       - Colonizer: INIT 1.0, FOCUS 0.8, REDIRECT 0.9, FEEDBACK 0.7
       - Route-setter: INIT 1.0, FOCUS 0.9, REDIRECT 0.8, FEEDBACK 0.8
       - Builder: INIT 0.9, FOCUS 1.0, REDIRECT 0.7, FEEDBACK 0.9
       - Watcher: INIT 0.8, FOCUS 0.9, REDIRECT 1.0, FEEDBACK 1.0
       - Scout: INIT 0.9, FOCUS 0.7, REDIRECT 0.8, FEEDBACK 0.8
       - Architect: INIT 0.8, FOCUS 0.8, REDIRECT 0.9, FEEDBACK 1.0

    3. **Decay calculation formulas present** for all four pheromone types

    4. **Effective strength formula**: effective = decayed_strength × sensitivity

    5. **Response thresholds**: >0.1, >0.3, >0.5 specified

    6. **Pheromone combinations section** documented

    Create a verification report listing each caste's conformance.
  </action>
  <verify>
    1. Read all six Worker Ant prompts
    2. Verify "## Read Active Pheromones" section exists in each
    3. Verify sensitivity values match worker_ants.json
    4. Verify decay formulas are present
    5. Verify effective strength formula documented
  </verify>
  <done>All six Worker Ants have pheromone reading instructions with correct sensitivity values</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Complete pheromone communication system (3 commands + 6 Worker Ant updates)</what-built>
  <how-to-verify>
    Manual verification steps:

    1. **Test FOCUS command**:
       - Run `/ant:focus "test authentication"`
       - Verify output shows formatted ASCII table
       - Run `cat .aether/data/pheromones.json | jq '.active_pheromones[-1]'`
       - Verify: type="FOCUS", strength=0.7, decay_rate=3600

    2. **Test REDIRECT command**:
       - Run `/ant:redirect "avoid callbacks"`
       - Verify output shows formatted ASCII table
       - Check pheromones.json for: type="REDIRECT", strength=0.9, decay_rate=86400

    3. **Test FEEDBACK command**:
       - Run `/ant:feedback "good progress"`
       - Verify output shows formatted ASCII table
       - Check pheromones.json for: type="FEEDBACK", strength=0.5, decay_rate=21600

    4. **Verify Worker Ant prompts**:
       - Open any Worker Ant prompt (e.g., .aether/workers/builder-ant.md)
       - Verify "## Read Active Pheromones" section exists
       - Verify sensitivity values match caste
       - Verify decay calculation examples present

    Expected outcome:
    - All commands execute without errors
    - All pheromones created in pheromones.json with correct schema
    - All Worker Ants have pheromone reading instructions
  </how-to-verify>
  <resume-signal>Type "approved" if verification passes, or describe issues found</resume-signal>
</task>

</tasks>

<verification>
After completion, verify:
1. All three pheromone commands work correctly
2. All six Worker Ant prompts have pheromone reading instructions
3. Pheromone objects created with correct schema and decay rates
4. Effective strength calculation documented in all prompts
5. Human verification checkpoint passed
</verification>

<success_criteria>
Phase 3 pheromone communication system is fully functional:
- Queen can emit FOCUS, REDIRECT, FEEDBACK pheromones
- All Worker Ants can read and interpret pheromone signals
- Effective strength calculation (signal × sensitivity) is documented
- Pheromone combination response logic is documented
- Ready for Phase 4: Triple-Layer Memory
</success_criteria>

<output>
After completion, create `.planning/phases/03-pheromone-communication/03-06-SUMMARY.md`
</output>
