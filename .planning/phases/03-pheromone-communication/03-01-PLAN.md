---
phase: 03-pheromone-communication
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - .claude/commands/ant/focus.md
autonomous: true
user_setup: []

must_haves:
  truths:
    - "Queen can emit FOCUS pheromone with /ant:focus command"
    - "FOCUS pheromone appears in pheromones.json active_pheromones array"
    - "FOCUS pheromone has 1-hour half-life (decay_rate: 3600 seconds)"
    - "Command follows init.md pattern (jq + atomic-write)"
  artifacts:
    - path: ".claude/commands/ant/focus.md"
      provides: "FOCUS pheromone emission command"
      contains: "jq command to append FOCUS pheromone to active_pheromones"
    - path: ".aether/data/pheromones.json"
      provides: "Active pheromone storage"
      contains: "active_pheromones array with FOCUS signals"
  key_links:
    - from: ".claude/commands/ant/focus.md"
      to: ".aether/data/pheromones.json"
      via: "jq append to active_pheromones array"
      pattern: "\\.active_pheromones \\+="
---

<objective>
Create the /ant:focus command that emits a FOCUS pheromone to guide colony attention to specific areas.

Purpose: Enable Queen to guide colony prioritization through medium-strength attract signals with 1-hour decay
Output: Working /ant:focus command that creates FOCUS pheromone objects in pheromones.json
</objective>

<execution_context>
@~/.claude/cosmic-dev-system/workflows/execute-plan.md
@~/.claude/cosmic-dev-system/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.claude/commands/ant/init.md
@.aether/data/pheromones.json
@.planning/phases/03-pheromone-communication/03-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Rewrite /ant:focus command using init.md pattern</name>
  <files>.claude/commands/ant/focus.md</files>
  <action>
    Rewrite .claude/commands/ant/focus.md to follow the exact pattern from init.md (lines 69-95):

    1. **Validate input**: Check if focus area argument is provided
    2. **Load state**: Set PHEROMONES=".aether/data/pheromones.json"
    3. **Create FOCUS pheromone object** using jq:
       - id: "focus_$(date +%s)"
       - type: "FOCUS"
       - strength: 0.7 (from pheromones.json default)
       - created_at: ISO-8601 timestamp
       - decay_rate: 3600 (1 hour in seconds)
       - metadata.source: "queen"
       - metadata.caste: null
       - metadata.context: the focus area argument
    4. **Append to active_pheromones array** using jq
    5. **Atomic write** via .aether/utils/atomic-write.sh atomic_write_from_file
    6. **Display formatted output** showing the FOCUS signal was emitted

    IMPORTANT: Remove all Python code from the existing focus.md draft. This is a bash/jq implementation, not Python.

    Output format should match init.md style:
    ```
    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
    â•‘  ğŸœ FOCUS Pheromone Emitted                                  â•‘
    â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
    â•‘  Area: "{focus_area}"                                        â•‘
    â•‘  Type: FOCUS (attract signal)                                â•‘
    â•‘  Strength: 70%                                               â•‘
    â•‘  Half-Life: 1 hour                                          â•‘
    â•‘                                                               â•‘
    â•‘  Colony Response:                                            â•‘
    â•‘  âœ“ Builder will prioritize {focus_area}                     â•‘
    â•‘  âœ“ Route-setter will include in planning                    â•‘
    â•‘  âœ“ Scout will research {focus_area} first                   â•‘
    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    ```

    Do NOT implement learning/occurrence tracking - that's for later phases. Just create the pheromone signal.
  </action>
  <verify>Run /ant:focus "test area" and verify:
    1. Command executes without errors
    2. jq command appends to active_pheromones array
    3. New pheromone object has type: "FOCUS", strength: 0.7, decay_rate: 3600
    4. Display output shows formatted ASCII table</verify>
  <done>FOCUS pheromone appears in pheromones.json with correct schema and colony responds to focus signals</done>
</task>

</tasks>

<verification>
After completion, verify:
1. /ant:focus command executes successfully
2. FOCUS pheromone object created in pheromones.json active_pheromones array
3. Pheromone has correct decay_rate: 3600 (1 hour)
4. Output formatted as ASCII table matching init.md style
5. No Python code in command (pure bash/jq)
</verification>

<success_criteria>
Queen can run `/ant:focus "authentication module"` and see FOCUS pheromone created in pheromones.json with 1-hour half-life decay rate
</success_criteria>

<output>
After completion, create `.planning/phases/03-pheromone-communication/03-01-SUMMARY.md`
</output>
