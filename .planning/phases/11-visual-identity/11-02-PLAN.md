---
phase: 11-visual-identity
plan: 02
type: execute
wave: 2
depends_on:
  - "11-01"
files_modified:
  - .claude/commands/ant/status.md
  - .aether/aether-utils.sh
autonomous: true
requirements:
  - VIS-03
  - VIS-02

must_haves:
  truths:
    - "User can see at a glance what percentage of phases are complete"
    - "User can see what percentage of tasks in the current phase are complete"
    - "Command completion ends with actionable 'Next Up' suggestions"
  artifacts:
    - path: ".claude/commands/ant/status.md"
      provides: "Updated /ant:status command with progress bars and Next Up block"
      contains: "progress"
    - path: ".aether/aether-utils.sh"
      provides: "Progress bar helper function"
      contains: "generate-progress-bar"
  key_links:
    - from: "/ant:status"
      to: "progress display"
      via: "helper function call"
      pattern: "generate-progress-bar"
---

<objective>
Add visual progress bars to `/ant:status` showing phase and task completion, plus a "Next Up" block at command completion with copy-paste-ready commands.

Purpose: Give users immediate visual feedback on project progress and clear next steps without having to interpret numbers.
Output: Updated status.md command with progress bar display and Next Up block.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/11-visual-identity/11-CONTEXT.md
@.planning/phases/11-visual-identity/11-RESEARCH.md
@.claude/commands/ant/status.md
@.aether/aether-utils.sh
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add progress bar helper to aether-utils.sh</name>
  <files>.aether/aether-utils.sh</files>
  <action>
Add a `generate-progress-bar` helper function to `.aether/aether-utils.sh`.

The existing `update-progress` function (lines 818-849) provides reference implementation. Create a simpler, reusable function that returns just the bar string.

Add this function after `get_caste_emoji()` (around line 116):

```bash
# --- Progress bar helper ---
# Usage: generate-progress-bar <current> <total> [width]
# Returns: "[â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘] 8/20" format string
generate-progress-bar() {
  local current="${1:-0}"
  local total="${2:-1}"
  local width="${3:-20}"

  # Prevent division by zero
  [[ "$total" -lt 1 ]] && total=1
  [[ "$current" -lt 0 ]] && current=0
  [[ "$current" -gt "$total" ]] && current="$total"

  # Calculate filled/empty segments
  local filled=$(( (current * width) / total ))
  local empty=$(( width - filled ))

  # Build bar with Unicode block characters
  local bar=""
  for ((i=0; i<filled; i++)); do bar+="â–ˆ"; done
  for ((i=0; i<empty; i++)); do bar+="â–‘"; done

  echo "[$bar] $current/$total"
}
```

Also add a case handler for CLI access:
```bash
  generate-progress-bar)
    # Usage: aether-utils.sh generate-progress-bar <current> <total> [width]
    shift
    generate-progress-bar "$@"
    ;;
```

Add this in the main `case "$cmd"` block (after the existing cases).
  </action>
  <verify>
    # Verify function exists and works
    grep -q "generate-progress-bar()" .aether/aether-utils.sh && \
    bash .aether/aether-utils.sh generate-progress-bar 4 5 20 | grep -q "4/5" && \
    echo "PASS: generate-progress-bar function added and working"
  </verify>
  <done>Helper function exists and returns correctly formatted progress bars</done>
</task>

<task type="auto">
  <name>Task 2: Update /ant:status with progress bars and Next Up block</name>
  <files>.claude/commands/ant/status.md</files>
  <action>
Update `.claude/commands/ant/status.md` to display visual progress bars and add a "Next Up" block.

**Change 1: Add progress bar display (Step 3 section)**

Replace the current phase/task display:
```
ğŸ“ Phase <N>/<M>: <phase name>
   Tasks: <completed>/<total> complete
```

With stacked progress bars:
```
ğŸ“ Progress
   Phase: [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘] 12/20 phases
   Tasks: [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘] 4/5 tasks in Phase 12
```

Add a step before Step 3 to generate progress bars:
```markdown
### Step 2.7: Generate Progress Bars

Calculate progress metrics:

Run using the Bash tool with description "Computing phase progress...":
```bash
# Get current phase and total phases
current_phase=$(jq -r '.current_phase // 0' .aether/data/COLONY_STATE.json)
total_phases=$(jq -r '.plan.phases | length' .aether/data/COLONY_STATE.json)

# Calculate task progress in current phase
if [[ "$current_phase" -gt 0 && "$current_phase" -le "$total_phases" ]]; then
  phase_idx=$((current_phase - 1))
  tasks_completed=$(jq -r ".plan.phases[$phase_idx].tasks // [] | map(select(.status == \"completed\")) | length" .aether/data/COLONY_STATE.json)
  tasks_total=$(jq -r ".plan.phases[$phase_idx].tasks // [] | length" .aether/data/COLONY_STATE.json)
else
  tasks_completed=0
  tasks_total=0
fi

# Generate progress bars
phase_bar=$(bash .aether/aether-utils.sh generate-progress-bar "$current_phase" "$total_phases" 20)
task_bar=$(bash .aether/aether-utils.sh generate-progress-bar "$tasks_completed" "$tasks_total" 20)

echo "{\"phase_bar\": \"$phase_bar\", \"task_bar\": \"$task_bar\", \"phase_name\": \"$(jq -r ".plan.phases[$phase_idx].name // \"Unnamed\"" .aether/data/COLONY_STATE.json)\"}"
```

Store the output for display in Step 3.
```

**Change 2: Update Step 3 display section**

Update the output format (around lines 143-164) to use progress bars:

```markdown
Output format:

```
       .-.
      (o o)  AETHER COLONY
      | O |  Status Report
       `-`
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ‘‘ Goal: <goal (truncated to 60 chars)>

ğŸ“ Progress
   Phase: [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘] 2/10 phases
   Tasks: [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘] 4/5 tasks in Phase 2

ğŸ¯ Focus: <focus_count> areas | ğŸš« Avoid: <constraints_count> patterns
ğŸ§  Instincts: <total> learned (<high_confidence> strong)
ğŸš© Flags: <blockers> blockers | <issues> issues | <notes> notes
ğŸ† Milestone: <milestone> (<version>)
ğŸ’­ Dreams: <dream_count> recorded (latest: <latest_dream>)

State: <state>
```

**Change 3: Add Next Up block at end of Step 3**

Add after the existing output format:

```markdown
**At the end of the output, add a Next Up block:**

```
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸœ Next Up
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   /ant:build {next_phase}     ğŸ”¨ Continue building
   /ant:status                 ğŸ“Š Check progress
   /ant:focus                  ğŸ¯ Guide attention
```

The primary command should be based on colony state:
- IDLE â†’ `/ant:init`
- READY â†’ `/ant:build {current_phase + 1}`
- EXECUTING â†’ `/ant:continue`
- PLANNING â†’ `/ant:plan`
```
  </action>
  <verify>
    # Verify status.md has progress bar references and Next Up block
    grep -q "progress" .claude/commands/ant/status.md && \
    grep -q "generate-progress-bar" .claude/commands/ant/status.md && \
    grep -q "Next Up" .claude/commands/ant/status.md && \
    echo "PASS: status.md updated with progress bars and Next Up"
  </verify>
  <done>/ant:status displays progress bars and ends with Next Up block</done>
</task>

</tasks>

<verification>
After all tasks complete:

1. Run `bash .aether/aether-utils.sh generate-progress-bar 3 4 20` - should show `[â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘] 3/4`
2. Verify status.md contains progress bar generation logic
3. Verify status.md contains Next Up block format
4. Run `npm run lint:sync` to verify no sync issues
</verification>

<success_criteria>
- `generate-progress-bar` function in aether-utils.sh works correctly
- `/ant:status` displays visual progress bars for phase and task completion
- `/ant:status` ends with a "Next Up" block containing at least one command
- `npm run lint:sync` passes
</success_criteria>

<output>
After completion, create `.planning/phases/11-visual-identity/11-02-SUMMARY.md`
</output>
