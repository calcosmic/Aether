---
phase: 02-core-infrastructure
plan: 03
type: execute
wave: 1
depends_on: []
files_modified:
  - .aether/aether-utils.sh
autonomous: true
requirements:
  - CMD-03
  - CMD-08
  - ERR-03

must_haves:
  truths:
    - "/ant:colonize can read pheromones from .aether/data/pheromones.json"
    - "pheromone-read function returns valid JSON"
    - "Error messages are user-friendly when pheromones file missing"
  artifacts:
    - path: ".aether/aether-utils.sh"
      provides: "pheromone-read function"
      contains: "pheromone-read"
  key_links:
    - from: "pheromone-read"
      to: ".aether/data/pheromones.json"
      via: "file read"
      pattern: "pheromones\\.json"
---

<objective>
Implement pheromone-read subcommand.

Purpose: Required for /ant:colonize (CMD-03) to analyze existing codebase with pheromone awareness. Currently pheromone-read doesn't exist - only pheromone-export exists.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-core-infrastructure/02-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Implement pheromone-read function</name>
  <files>.aether/aether-utils.sh</files>
  <action>
1. Find where pheromone-export is defined (line ~3655)
2. Add pheromone-read function near it (maintain alphabetical order)
3. Function should:
   - Accept optional pheromone type argument (focus, redirect, feedback) or all
   - Read from .aether/data/pheromones.json
   - Return JSON array of pheromones via json_ok
   - Handle missing file gracefully with json_err

Reference pheromone-export for file path patterns and json_ok/json_err usage.

Pseudo-code:
```
pheromone-read)
  pher_type="${1:-all}"
  pher_file=".aether/data/pheromones.json"
  [[ -f "$pher_file" ]] || json_err "$E_FILE_NOT_FOUND" "Pheromones file not found. Run /ant:colonize first."
  # Read and filter pheromones based on type
  json_ok "{\"pheromones\":[...]}"
  ;;
```
  </action>
  <verify>
grep -n "^pheromone-read\)" .aether/aether-utils.sh
  </verify>
  <done>pheromone-read function exists and can be called</done>
</task>

<task type="auto">
  <name>Test pheromone-read with colony</name>
  <files>.aether/aether-utils.sh</files>
  <action>
1. First ensure a test colony exists: create minimal COLONY_STATE.json
2. Create pheromones.json with sample data
3. Run: bash .aether/aether-utils.sh pheromone-read
4. Verify JSON output is valid
5. Test with specific type: bash .aether/aether-utils.sh pheromone-read focus
6. Test error case: remove pheromones.json, verify error message
  </action>
  <verify>
jq empty <<< "$(bash .aether/aether-utils.sh pheromone-read 2>/dev/null)"
  </verify>
  <done>pheromone-read returns valid JSON with pheromones array</done>
</task>

</tasks>

<verification>
Run: bash .aether/aether-utils.sh pheromone-read
Verify output is valid JSON: echo "$output" | jq .
</verification>

<success_criteria>
1. pheromone-read function exists in aether-utils.sh
2. Returns valid JSON with pheromones
3. Handles missing file with user-friendly error
4. Supports filtering by type (focus, redirect, feedback)
</success_criteria>

<output>
After completion, create `.planning/phases/02-core-infrastructure/02-03-SUMMARY.md`
</output>
