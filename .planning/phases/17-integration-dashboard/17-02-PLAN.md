---
phase: 17-integration-dashboard
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - .claude/commands/ant/continue.md
autonomous: true

must_haves:
  truths:
    - "Running /ant:continue displays a phase completion summary showing tasks completed, errors encountered, and decisions made BEFORE advancing to the next phase"
    - "The phase review shows different information than the final result display (retrospective vs prospective)"
    - "continue.md has 8 steps instead of 7, with the new Phase Completion Summary as Step 3"
  artifacts:
    - path: ".claude/commands/ant/continue.md"
      provides: "Phase review workflow with completion summary"
      contains: "Phase Completion Summary"
    - path: ".claude/commands/ant/continue.md"
      provides: "Task completion display"
      contains: "Completed:"
    - path: ".claude/commands/ant/continue.md"
      provides: "8-step progress display"
      contains: "Step 8:"
  key_links:
    - from: ".claude/commands/ant/continue.md Step 3"
      to: ".aether/data/PROJECT_PLAN.json"
      via: "reads tasks from current phase"
      pattern: "tasks.*completed"
    - from: ".claude/commands/ant/continue.md Step 3"
      to: ".aether/data/errors.json"
      via: "filters errors by current phase"
      pattern: "errors.*phase"
    - from: ".claude/commands/ant/continue.md Step 3"
      to: ".aether/data/memory.json"
      via: "reads decisions array"
      pattern: "decisions"
---

<objective>
Add a phase review workflow to continue.md that displays a completion summary before advancing to the next phase.

Purpose: Users see what happened during a phase (tasks completed, errors, decisions) before moving on -- providing a quality gate with retrospective value. Fulfills REV-01 and REV-02. REV-03 (learning extraction) is already satisfied by continue.md Step 3.
Output: Updated `.claude/commands/ant/continue.md` with Phase Completion Summary step.
</objective>

<execution_context>
@~/.claude/cosmic-dev-system/workflows/execute-plan.md
@~/.claude/cosmic-dev-system/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/17-integration-dashboard/17-RESEARCH.md
@.claude/commands/ant/continue.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Insert Phase Completion Summary as new Step 3</name>
  <files>.claude/commands/ant/continue.md</files>
  <action>
Read `.claude/commands/ant/continue.md`. Insert a new Step 3 between the current Step 2 ("Determine Next Phase") and current Step 3 ("Extract Phase Learnings"). Then renumber all subsequent steps (old 3 becomes 4, old 4 becomes 5, etc., up to 8 total).

**New Step 3: Phase Completion Summary**

Insert this content:

```markdown
### Step 3: Phase Completion Summary

Before advancing, display a summary of the completed phase using data from the state files read in Step 1.

Output:

```
---------------------------------------------------
PHASE <N> REVIEW: <phase_name>
---------------------------------------------------

  Tasks:
    [x] <task_id>: <description>
    [x] <task_id>: <description>
    ...
    Completed: <N>/<total>

  Errors:
    <count> errors encountered
    (list severity counts: N critical, N high, N medium, N low)

  Decisions:
    <count> decisions logged during this phase
    (list last 3 decisions from memory.json decisions array: "<content>")

---------------------------------------------------
```

Get task data from `PROJECT_PLAN.json` -- look at the current phase's `tasks` array. Show `[x]` for completed, `[ ]` for incomplete.

Get error data from `errors.json` -- filter the `errors` array by `phase` field matching the current phase number. Count by severity level.

Get decision data from `memory.json` -- count the `decisions` array entries. Show last 3 decisions.

If no errors were encountered during this phase:
```
  Errors: None
```

If no decisions were logged:
```
  Decisions: None
```

This step is DISPLAY ONLY -- it reads state but does not write anything. The purpose is to give the user a retrospective before the phase advances.
```

**Renumber subsequent steps:**
- Old Step 3 (Extract Phase Learnings) becomes Step 4
- Old Step 4 (Clean Expired Pheromones) becomes Step 5
- Old Step 5 (Write Events) becomes Step 6
- Old Step 6 (Update Colony State) becomes Step 7
- Old Step 7 (Display Result) becomes Step 8

**Update Step 8 (Display Result)** step progress to show 8 steps:

```
  ✓ Step 1: Read State
  ✓ Step 2: Determine Next Phase
  ✓ Step 3: Phase Completion Summary
  ✓ Step 4: Extract Phase Learnings
  ✓ Step 5: Clean Expired Pheromones
  ✓ Step 6: Write Events
  ✓ Step 7: Update Colony State
  ✓ Step 8: Display Result
```

Do NOT change any existing step content -- only insert the new step and update numbers and the progress display.

IMPORTANT: The Phase Completion Summary (Step 3, retrospective) shows DIFFERENT content from the Display Result (Step 8, prospective). Step 3 looks back at what happened. Step 8 looks forward at what's next. Do not duplicate information between them.
  </action>
  <verify>Read continue.md. Confirm 8 steps total. Confirm Step 3 is "Phase Completion Summary" with tasks/errors/decisions display. Confirm step progress list shows 8 steps. Confirm existing step logic is unchanged (just renumbered).</verify>
  <done>continue.md shows a phase completion summary (tasks, errors, decisions) as Step 3 before advancing. All subsequent steps correctly renumbered. Step 8 progress display shows 8 steps.</done>
</task>

</tasks>

<verification>
1. Read `.claude/commands/ant/continue.md` and verify 8 steps exist
2. Verify Step 3 is "Phase Completion Summary" with box-drawing formatted output
3. Verify Step 3 reads from PROJECT_PLAN.json (tasks), errors.json (errors by phase), and memory.json (decisions)
4. Verify Step 3 is display-only (no writes)
5. Verify Step 8 progress display lists all 8 steps
6. Verify no existing step content was modified (only renumbered)
7. File should be approximately 210-220 lines (was 158, adding ~55 lines for new step)
</verification>

<success_criteria>
- continue.md has 8 steps with Phase Completion Summary as Step 3
- Phase review shows tasks completed vs total from PROJECT_PLAN.json
- Phase review shows errors filtered by current phase from errors.json
- Phase review shows recent decisions from memory.json
- Step 3 (retrospective) and Step 8 (prospective) show different information
- All existing step logic preserved, only renumbered
- Requirements REV-01 and REV-02 are satisfied
</success_criteria>

<output>
After completion, create `.planning/phases/17-integration-dashboard/17-02-SUMMARY.md`
</output>
