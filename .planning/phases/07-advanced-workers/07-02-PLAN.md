---
phase: 07-advanced-workers
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - .aether/commands/claude/chaos.md
  - .claude/commands/ant/chaos.md
  - .aether/commands/opencode/chaos.md
  - .aether/commands/claude/archaeology.md
  - .claude/commands/ant/archaeology.md
  - .aether/commands/opencode/archaeology.md
autonomous: true
requirements: [ADV-02, ADV-03]

must_haves:
  truths:
    - "/ant:chaos produces a structured 5-scenario resilience report"
    - "/ant:chaos creates blocker flags for critical/high findings"
    - "/ant:archaeology produces a structured excavation report with git history analysis"
    - "Claude Code copies match source of truth exactly (no swarm-display-text drift)"
  artifacts:
    - path: ".aether/commands/claude/chaos.md"
      provides: "Chaos command definition (source of truth)"
    - path: ".claude/commands/ant/chaos.md"
      provides: "Chaos command (Claude Code copy, identical to SoT)"
    - path: ".aether/commands/opencode/chaos.md"
      provides: "Chaos command (OpenCode copy, normalize-args adapted)"
    - path: ".aether/commands/claude/archaeology.md"
      provides: "Archaeology command definition (source of truth)"
    - path: ".claude/commands/ant/archaeology.md"
      provides: "Archaeology command (Claude Code copy, identical to SoT)"
    - path: ".aether/commands/opencode/archaeology.md"
      provides: "Archaeology command (OpenCode copy, normalize-args adapted)"
  key_links:
    - from: ".aether/commands/claude/chaos.md"
      to: ".aether/aether-utils.sh"
      via: "flag-add for blocker creation"
      pattern: "flag-add"
    - from: ".aether/commands/claude/archaeology.md"
      to: "git log/blame"
      via: "git commands for history analysis"
      pattern: "git log|git blame"
---

<objective>
Fix the known sync drift in Chaos and Archaeology commands, and verify both produce correct output.

Purpose: Chaos and Archaeology have a specific known issue: the Claude Code copies use `swarm-display-text` where the source of truth uses `swarm-display-inline`. This drift must be resolved, and both commands verified.
Output: Synced chaos.md and archaeology.md across all 3 locations
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.aether/commands/claude/chaos.md
@.claude/commands/ant/chaos.md
@.aether/commands/opencode/chaos.md
@.aether/commands/claude/archaeology.md
@.claude/commands/ant/archaeology.md
@.aether/commands/opencode/archaeology.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Fix Chaos command sync drift and verify</name>
  <files>.aether/commands/claude/chaos.md, .claude/commands/ant/chaos.md, .aether/commands/opencode/chaos.md</files>
  <action>
  The known issue: `.claude/commands/ant/chaos.md` uses `swarm-display-text` at Step 5 line ~228, but the source of truth `.aether/commands/claude/chaos.md` uses `swarm-display-inline`.

  1. **Read the source of truth** (`.aether/commands/claude/chaos.md`) and audit:
     - Verify `swarm-display-init`, `swarm-display-update`, `swarm-display-inline` references are correct
     - Verify `flag-add` syntax in Step 6.5 matches the aether-utils.sh signature: `flag-add <type> <title> <description> [source] [phase]`
     - Verify `activity-log` syntax in Step 7
     - Check the JSON report output structure in Step 6 is valid

  2. **Fix the Claude Code copy**: Replace `.claude/commands/ant/chaos.md` with an exact copy of the source of truth. This resolves the `swarm-display-text` vs `swarm-display-inline` drift.

  3. **Verify the OpenCode copy** (`.aether/commands/opencode/chaos.md`): Confirm it has:
     - Step -1 normalize-args block
     - `$ARGUMENTS` replaced with `$normalized_args`
     - OpenCode convention: `swarm-display-inline` calls replaced with `swarm-display-text` (this is CORRECT for OpenCode -- it should differ from SoT here)
     - If OpenCode copy has drifted beyond these expected differences, resync from SoT with adaptations.

  Run diff to verify all 3 copies have only expected differences.
  </action>
  <verify>
  diff SoT vs Claude Code = identical.
  diff SoT vs OpenCode = only normalize-args and swarm-display-text differences.
  </verify>
  <done>Chaos command synced across all 3 locations, sync drift resolved</done>
</task>

<task type="auto">
  <name>Task 2: Fix Archaeology command sync drift and verify</name>
  <files>.aether/commands/claude/archaeology.md, .claude/commands/ant/archaeology.md, .aether/commands/opencode/archaeology.md</files>
  <action>
  Same known issue as chaos: `.claude/commands/ant/archaeology.md` uses `swarm-display-text` at Step 7 line ~214, but the source of truth uses `swarm-display-inline`.

  1. **Read the source of truth** (`.aether/commands/claude/archaeology.md`) and audit:
     - Verify `swarm-display-init`, `swarm-display-update`, `swarm-display-inline` references are correct
     - Verify git command patterns in Steps 2-5 (git log, git blame, git show)
     - Verify `activity-log` syntax in Step 8

  2. **Fix the Claude Code copy**: Replace `.claude/commands/ant/archaeology.md` with an exact copy of the source of truth.

  3. **Verify the OpenCode copy** (`.aether/commands/opencode/archaeology.md`): Confirm it has the correct OpenCode adaptations (same pattern as chaos).

  Run diff to verify all 3 copies have only expected differences.
  </action>
  <verify>
  diff SoT vs Claude Code = identical.
  diff SoT vs OpenCode = only normalize-args and swarm-display-text differences.
  </verify>
  <done>Archaeology command synced across all 3 locations, sync drift resolved</done>
</task>

</tasks>

<verification>
1. All 6 command files (3 per command) properly synced
2. Chaos Claude Code no longer has swarm-display-text drift
3. Archaeology Claude Code no longer has swarm-display-text drift
4. OpenCode copies have correct platform-specific adaptations
5. No broken function references in any copy
</verification>

<success_criteria>
- /ant:chaos command definition has correct function references and synced copies
- /ant:archaeology command definition has correct function references and synced copies
- Known sync drift between source of truth and Claude Code copies is resolved
</success_criteria>

<output>
After completion, create `.planning/phases/07-advanced-workers/07-02-SUMMARY.md`
</output>
